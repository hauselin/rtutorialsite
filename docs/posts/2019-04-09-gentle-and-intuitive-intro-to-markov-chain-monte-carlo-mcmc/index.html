<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="radix" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

  <!--radix_placeholder_meta_tags-->
<title>Data science with R: Bayesian inference and MCMC sampling introduction</title>

<meta property="description" itemprop="description" content="A gentle and intuitive introduction to Markov Chain Monte Carlo sampling with rejection sampling."/>

<link rel="canonical" href="https://hausetutorials.netlify.com/posts/2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2019-04-09"/>
<meta property="article:created" itemprop="dateCreated" content="2019-04-09"/>
<meta name="article:author" content="Hause Lin"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Data science with R: Bayesian inference and MCMC sampling introduction"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="A gentle and intuitive introduction to Markov Chain Monte Carlo sampling with rejection sampling."/>
<meta property="og:url" content="https://hausetutorials.netlify.com/posts/2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc/"/>
<meta property="og:image" content="https://hausetutorials.netlify.com/posts/2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc/./gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/figure-html5/unnamed-chunk-19-1.png"/>
<meta property="og:image:width" content="1248"/>
<meta property="og:image:height" content="768"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Data science with R"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Data science with R: Bayesian inference and MCMC sampling introduction"/>
<meta property="twitter:description" content="A gentle and intuitive introduction to Markov Chain Monte Carlo sampling with rejection sampling."/>
<meta property="twitter:url" content="https://hausetutorials.netlify.com/posts/2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc/"/>
<meta property="twitter:image" content="https://hausetutorials.netlify.com/posts/2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc/./gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/figure-html5/unnamed-chunk-19-1.png"/>
<meta property="twitter:image:width" content="1248"/>
<meta property="twitter:image:height" content="768"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Data science with R: Bayesian inference and MCMC sampling introduction"/>
<meta name="citation_fulltext_html_url" content="https://hausetutorials.netlify.com/posts/2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2019/04/09"/>
<meta name="citation_publication_date" content="2019/04/09"/>
<meta name="citation_author" content="Hause Lin"/>
<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["creative_commons","title","description","preview","author","date","output","draft","categories","repository_url","editor_options","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["Bayesian inference and MCMC sampling introduction"]},{"type":"character","attributes":{},"value":["A gentle and intuitive introduction to Markov Chain Monte Carlo sampling with rejection sampling."]},{"type":"character","attributes":{},"value":["./gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/figure-html5/unnamed-chunk-19-1.png"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Hause Lin"]}]}]},{"type":"character","attributes":{},"value":["04-09-2019"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["radix::radix_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["bayes","mcmc"]},{"type":"character","attributes":{},"value":["https://github.com/hauselin/rtutorialsite/blob/master/_posts/2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc/gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc.Rmd"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["chunk_output_type"]}},"value":[{"type":"character","attributes":{},"value":["console"]}]},{"type":"character","attributes":{},"value":["https://hausetutorials.netlify.com/posts/2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc/"]},{"type":"character","attributes":{},"value":["https://hausetutorials.netlify.com/posts/2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/bowser-1.9.3/bowser.min.js","gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/distill-2.2.21/template.v2.js","gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/figure-html5/unnamed-chunk-14-1.png","gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/figure-html5/unnamed-chunk-15-1.png","gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/figure-html5/unnamed-chunk-17-1.png","gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/figure-html5/unnamed-chunk-18-1.png","gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/figure-html5/unnamed-chunk-19-1.png","gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/figure-html5/unnamed-chunk-3-1.png","gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/figure-html5/unnamed-chunk-4-1.png","gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/figure-html5/unnamed-chunk-9-1.png","gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/jquery-1.11.3/jquery.min.js","gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.radix-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.radix-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #455a64;
  font-size: 15px;
  font-weight: 300;
}

.radix-site-nav a {
  color: inherit;
  text-decoration: none;
}

.radix-site-nav a:hover {
  color: white;
}

@media print {
  .radix-site-nav {
    display: none;
  }
}

.radix-site-header {

}

.radix-site-footer {

}


/* Site Header */

.radix-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.radix-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .radix-site-header .nav-left {
    margin-left: 0;
  }
}


.radix-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.radix-site-header a,
.radix-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.radix-site-header .title {
  font-size: 18px;
}

.radix-site-header .logo {
  padding: 0;
}

.radix-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.radix-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .radix-site-header .logo img {
    display: inline-block;
  }
  .radix-site-header .nav-left {
    margin-left: 20px;
  }
  .radix-site-header .nav-right {
    margin-right: 20px;
  }
  .radix-site-header .title {
    padding-left: 12px;
  }
}


.radix-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .radix-site-header a, .radix-site-header .nav-dropdown  {display: none;}
  .radix-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .radix-site-header .title {
    margin-left: 0;
  }
  .radix-site-header .nav-right {
    margin-right: 0;
  }
  .radix-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .radix-site-header.responsive {position: relative;}
  .radix-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .radix-site-header.responsive a,
  .radix-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .radix-site-header.responsive .nav-left,
  .radix-site-header.responsive .nav-right {
    width: 100%;
  }
  .radix-site-header.responsive .nav-dropdown {float: none;}
  .radix-site-header.responsive .nav-dropdown-content {position: relative;}
  .radix-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.radix-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

</style>

<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for table of contents */

.d-toc {
  color: rgba(0,0,0,0.8);
  font-size: 0.8em;
  line-height: 1em;
}

.d-toc-header {
  font-size: 0.6rem;
  font-weight: 400;
  color: rgba(0, 0, 0, 0.5);
  text-transform: uppercase;
  margin-top: 0;
  margin-bottom: 1.3em;
}

.d-toc a {
  border-bottom: none;
}

.d-toc ul {
  padding-left: 0;
}

.d-toc li>ul {
  padding-top: 0.8em;
  padding-left: 16px;
  margin-bottom: 0.6em;
}

.d-toc ul,
.d-toc li {
  list-style-type: none;
}

.d-toc li {
  margin-bottom: 0.9em;
}

.d-toc-separator {
  margin-top: 20px;
  margin-bottom: 2em;
}

.d-article-with-toc {
  border-top: none;
  padding-top: 0;
}



/* Tweak code blocks (note that this CSS is repeated above in an injection
   into the d-code shadow dom) */

d-code {
  overflow-x: auto !important;
}

pre.d-code code.d-code {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

pre.text-output {

  font-size: 12px;
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

@media(min-width: 768px) {

d-code {
  overflow-x: visible !important;
}

pre.d-code code.d-code  {
    padding-left: 18px;
    font-size: 14px;
}
pre.text-output {
  font-size: 14px;
}
}

/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}



/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}


/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // create d-bibliography
  var bibliography = $('<d-bibliography></d-bibliography>');
  $('#distill-bibliography').wrap(bibliography);

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace citations with <d-cite>
  $('.citation').each(function(i, val) {
    appendix = true;
    var cites = $(this).attr('data-cites').split(" ");
    var dt_cite = $('<d-cite></d-cite>');
    dt_cite.attr('key', cites.join());
    $(this).replaceWith(dt_cite);
  });
  // remove refs
  $('#refs').remove();

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-toc a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // replace code blocks with d-code
  $('pre>code').each(function(i, val) {
    var code = $(this);
    var pre = code.parent();
    var clz = "";
    var language = pre.attr('class');
    if (language) {
      // map unknown languages to "clike" (without this they just dissapear)
      if ($.inArray(language, ["bash", "clike", "css", "go", "html",
                               "javascript", "js", "julia", "lua", "markdown",
                               "markup", "mathml", "python", "svg", "xml"]) == -1)
        language = "clike";
      language = ' language="' + language + '"';
      var dt_code = $('<d-code block' + language + clz + '></d-code>');
      dt_code.text(code.text());
      pre.replaceWith(dt_code);
    } else {
      code.addClass('text-output').unwrap().changeElementType('pre');
    }
  });

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('d-code, pre.text-output, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // table of contents
    if (have_authors) // adjust border if we are in authors
      $('.d-toc').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // inject pre code styles (can't do this with a global stylesheet b/c a shadow root is used)
    $('d-code').each(function(i, val) {
      var style = document.createElement('style');
      style.innerHTML = 'pre code { padding-left: 10px; font-size: 12px; border-left: 2px solid rgba(0,0,0,0.1); } ' +
                        '@media(min-width: 768px) { pre code { padding-left: 18px; font-size: 14px; } }';
      if (this.shadowRoot)
        this.shadowRoot.appendChild(style);
    });

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-toc-header').remove();
  $('.d-toc').remove();
  $('.d-toc-separator').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.radix-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-134721506-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-134721506-5');
</script>
<style type="text/css">
.radix-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #383838;
  font-size: 15px;
  font-weight: 300;
}

</style>
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Bayesian inference and MCMC sampling introduction","description":"A gentle and intuitive introduction to Markov Chain Monte Carlo sampling with rejection sampling.","authors":[{"author":"Hause Lin","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#"}],"publishedDate":"2019-04-09T00:00:00.000+02:00","citationText":"Lin, 2019"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="radix-site-nav radix-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">Data science with R</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="http://escal.site">Effect size converter</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Tutorials
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="../../0000_install.html">Install R and packages</a>
<a href="../../0001_rbasics.html">R programming basics</a>
<a href="../../0002_tidyverse_datatable.html">tidyverse and data.table</a>
<a href="../../0003_ggplot_modelfitting.html">ggplot and model fitting</a>
<a href="../../0004_dataform_join.html">long/wide form data and joining</a>
</div>
</div>
<a href="../../articles.html">Articles</a>
<a href="https://twitter.com/hauselin">
<i class="fab fa-twitter"></i>
</a>
<a href="https://github.com/hauselin/rtutorialsite">
<i class="fab fa-github"></i>
</a>
<a href="https://scholar.google.ca/citations?user=4_ZopI0AAAAJ&amp;hl=en">
<i class="fab fa-google"></i>
</a>
<a href="../../articles.xml">
<i class="fa fa-rss"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Bayesian inference and MCMC sampling introduction</h1>
<p>A gentle and intuitive introduction to Markov Chain Monte Carlo sampling with rejection sampling.</p>
</div>

<div class="d-byline">
  Hause Lin  
  
<br/>04-09-2019
</div>

<div class="d-article">
<h3 class="d-toc-header">Table of Contents</h3>
<nav class="d-toc" id="TOC">
<ul>
<li><a href="#binomial-distribution-example-life-or-death-heads-or-tails">Binomial distribution example (life or death, heads or tails)</a></li>
<li><a href="#representing-beliefs-about-probability-with-the-beta-distribution">Representing beliefs about probability with the beta distribution</a></li>
<li><a href="#generate-prior-distribution-by-randomly-creating-data">Generate prior distribution by randomly creating data</a></li>
<li><a href="#define-likelihood-generative-model-and-simulate-data-samples">Define likelihood (generative model) and simulate data samples</a></li>
<li><a href="#identify-samples-that-match-our-observed-outcome">Identify samples that match our observed outcome</a></li>
<li><a href="#identify-prior-samples-associated-with-samples-that-match-observed-outcome-to-get-the-posterior">Identify prior samples associated with samples that match observed outcome to get the posterior!</a></li>
<li><a href="#summarize-posterior-samples">Summarize posterior samples</a></li>
<li><a href="#compare-prior-and-posterior">Compare prior and posterior</a></li>
<li><a href="#create-a-simple-function-for-further-simulations-and-exploration">Create a simple function for further simulations and exploration</a></li>
<li><a href="#exploring-different-parameters-sample-size-prior-shapes">Exploring different parameters (sample size, prior shapes)</a></li>
</ul>
</nav>
<hr class="d-toc-separator"/>
<p>Get source code for this RMarkdown script <a href="https://github.com/hauselin/rtutorialsite/blob/master/_posts/2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc/gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc.Rmd">here</a>.</p>
<p>Bayesian inference, priors, likelihood, posteriors, and especially Markov Chain Monte Carlo sampling can be mysterious. I will try to explain these concepts with a simple 1-dimensional example, using something known as <strong>rejection sampling</strong>, which is good for explaining how sampling works, but is never used in practice because it is highly inefficient (we’ll see what that means later on).</p>
<h2 id="binomial-distribution-example-life-or-death-heads-or-tails">Binomial distribution example (life or death, heads or tails)</h2>
<p>In a hospital, there are a total of 100 patients suffering from different deadly diseases. Doctor X is very optimistic and thinks that 83% of the patients will survive after 2 days. That is, Doctor X is expecting 83 patients to survive and 17 to die. This situation is like typical coin-toss scenarios, where survive is heads (coded 1) and death is tails (coded 0). Coin tosses and our scenario can be described using the binomial distribution.</p>
<p>Let’s generate some random data assuming we have 100 patients and 83% survival probability. Because the number is randomly generated from a binomial distribution (n = 100 and success = 83), we might not get exactly 83 as the output.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
n_patients &lt;- 100 # number of patients
survive_probability &lt;- 0.83 # probability of surviving
number_of_simulations &lt;- 1
rbinom(n = number_of_simulations, size = n_patients, prob = survive_probability)</code></pre>
<pre><code>
[1] 76</code></pre>
</div>
<p>Let’s repeat the scenario/simulation 10 times. Because the numbers are randomly generated from a binomial distribution (n = 100 and success = 83), we get slightly different numbers for each simulation. But these numbers should be close to 83.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
number_of_simulations &lt;- 10
rbinom(n = number_of_simulations, size = n_patients, prob = survive_probability)</code></pre>
<pre><code>
 [1] 86 78 89 87 88 81 83 83 87 83</code></pre>
</div>
<h2 id="representing-beliefs-about-probability-with-the-beta-distribution">Representing beliefs about probability with the beta distribution</h2>
<p>Doctor X believes 83% of the 100 patients will survive. In other words, he believes 83% is the most likely survival probability, whereas 82% and 84% are also likely, but less likely than 83%. We can represent Doctor X’s belief using a beta distribution, which is useful for describing probabilities because it ranges from 0 to 1, and has two parameters that define the shape of the distribution.</p>
<p>If you’re not familiar with the beta distribution, here are the key properties of the <a href="https://en.wikipedia.org/wiki/Beta_distribution">beta distribution</a>:</p>
<ul>
<li>it ranges from 0 to 1</li>
<li>shape1 and shape2 parameter can be thought of as the “success” and “failure” parameters</li>
<li>shape1 and shape2 are known as the alpha and beta parameters</li>
</ul>
<p>Below are the shapes of beta distributions with different shape1 and shape2 parameters. As shown below, the beta distribution is very flexible and changing the two parameters of the distribution can change the shape of the distribution drastically!</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
par(mfrow = c(2, 3)) # display subplots in a 2 x 3 grid
curve(dbeta(x, shape1 = 1.0, shape2 = 1.0), from = 0, to = 1) # uniform
curve(dbeta(x, shape1 = 1.2, shape2 = 1.2), from = 0, to = 1)
curve(dbeta(x, shape1 = 4, shape2 = 4), from = 0, to = 1) # normal looking
curve(dbeta(x, shape1 = 0.5, shape2 = 0.5), from = 0, to = 1) # u-shape
curve(dbeta(x, shape1 = 5, shape2 = 2), from = 0, to = 1) # success more likely than failure
curve(dbeta(x, shape1 = 3, shape2 = 6), from = 0, to = 1) # failure more likely than success</code></pre>
<p><img src="gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/figure-html5/unnamed-chunk-3-1.png" width="624" /></p>
</div>
<p>We can represent Doctor X’s belief with this beta distribution. Doctor X believes that 83% survival is the most likely to occur, and 40% survival is about half as likely to occur, but what this beta distribution says is that Doctor X believes that different survival probabilities ranging from 0 to 1 are plausible, even though he believes that 83% is most likely to occur.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
par(mfrow = c(1, 1)) # change back to showing plots in a 1 x 1 grid
curve(dbeta(x, shape1 = 3.5, shape2 = 1.5), from = 0, to = 1, 
      xlab = &quot;Plausible probabilities (survival percent or proportion)&quot;,
      ylab = &quot;Likelihood&quot;, 
      main = &quot;Doctor X&#39;s belief&quot;)
abline(v = 0.83, col = &quot;black&quot;, lwd = 3)</code></pre>
<p><img src="gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/figure-html5/unnamed-chunk-4-1.png" width="624" /></p>
</div>
<p>In Bayesian terminology, Doctor X’s belief is his prior (prior beliefs), <span class="math inline">\(P(\theta)\)</span>.</p>
<p>After 2 days, only 72 patients survived (28 died). Doctor X’s priors were not too accurate, it seems. Before we discuss how Doctor X should update/revise his beliefs, let’s return to our simulations from earlier on to see how rare/frequent it is to get 72 survivals (out of 100), assuming that we believe that 83% should survive.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
n_patients &lt;- 100 # number of patients
survive_probability &lt;- 0.83 # probability of surviving
number_of_simulations &lt;- 1 
rbinom(n = number_of_simulations, size = n_patients, prob = survive_probability)</code></pre>
<pre><code>
[1] 88</code></pre>
</div>
<p>Run <code>rbinom(n = number_of_simulations, size = n_patients, prob = survive_probability)</code> a few more times and see if you manage to get 72? You might never see any 72s. But if you keep trying, you eventually will!</p>
<p>Rather than manually re-run the function, let’s run 100,000 simulations to see how many 72s we observe.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
number_of_simulations &lt;- 100000
simdata &lt;- rbinom(n = number_of_simulations, size = n_patients, prob = survive_probability)
sum(simdata == 72) # total number of simulations that resulted in 72 survivals</code></pre>
<pre><code>
[1] 223</code></pre>
</div>
<p>Only 223 of 100000 simulations (assuming 83% survival probability) generated 72 survivals!</p>
<p>Remember, 83% is just one of the plausible parameter probability values in Doctor X’s prior beliefs distribution. See beta distribution reflecting his beliefs for the entire range of probability values in the figure above! 72% might not be as likely as 83% in his prior beliefs distribution, but it’s still fairly likely to occur!</p>
<p>Let’s run another 100,000 simulations to see how many 72s we can get, assuming the prior belief of survival is 72%.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
n_patients &lt;- 100 # number of patients
survive_probability &lt;- 0.72 # probability of surviving
number_of_simulations &lt;- 100000
simdata &lt;- rbinom(n = number_of_simulations, size = n_patients, prob = survive_probability)
sum(simdata == 72) # total number of simulations that resulted in 72 survivals</code></pre>
<pre><code>
[1] 8737</code></pre>
</div>
<p>This time, 8737 of 100000 simulations generated 72 survivals!</p>
<p>Now, we’re ready to understanding rejection sampling, MCMC, and how prior information and likelihood combine to form the posterior!</p>
<h2 id="generate-prior-distribution-by-randomly-creating-data">Generate prior distribution by randomly creating data</h2>
<p>First, let’s generate random samples to create Doctor X’s prior distribution. Remember, we’re using the beta distribution (ranges from 0 to 1) to generate probability values reflecting Doctor X’s beliefs.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
n_patients &lt;- 100 # number of patients
survive_probability &lt;- 0.83 # probability of surviving
prior_nsamples &lt;- 20000
priordist &lt;- rbeta(n = prior_nsamples, shape1 = 3.5, shape2 = 1.5)
head(priordist) # probability values</code></pre>
<pre><code>
[1] 0.1350260 0.4377662 0.6463718 0.2155319 0.4606485 0.5579412</code></pre>
</div>
<p>It’s always good to plot and visualize how your distributions look like.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
hist(priordist, main = paste0(&quot;Doctor X&#39;s prior&quot;, &quot; (prior samples = &quot;, length(priordist), &quot;)&quot;), 
     xlab = &quot;Plausible probability values&quot;, ylab = &quot;Count&quot;, xlim = c(0, 1))
abline(v = survive_probability, col = &quot;black&quot;, lwd = 3)</code></pre>
<p><img src="gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/figure-html5/unnamed-chunk-9-1.png" width="624" /></p>
</div>
<h2 id="define-likelihood-generative-model-and-simulate-data-samples">Define likelihood (generative model) and simulate data samples</h2>
<p>The likelihood, <span class="math inline">\(P(data|\theta)\)</span>, is the generative model, the theoretical model we think is generating the data.</p>
<p>Earlier on, we have only generated data with <code>rbinom()</code> assuming 83% and 72% survival. The <code>prob</code> parameter in the <code>rbinom()</code> function actually allows you to provide more than 1 probability at a time, which means we can enter the entire range of probability values ranging from 0 to 1 that reflects Doctor X’s prior belief beta distribution.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
length(priordist)</code></pre>
<pre><code>
[1] 20000</code></pre>
<pre class="r"><code>
head(priordist)</code></pre>
<pre><code>
[1] 0.1350260 0.4377662 0.6463718 0.2155319 0.4606485 0.5579412</code></pre>
<pre class="r"><code>
simulated_data &lt;- rbinom(n = length(priordist), size = n_patients, prob = priordist)
length(simulated_data)</code></pre>
<pre><code>
[1] 20000</code></pre>
<pre class="r"><code>
head(simulated_data)</code></pre>
<pre><code>
[1] 15 46 56 14 53 52</code></pre>
</div>
<p>If <code>rbinom(n = length(priordist), size = n_patients, prob = priordist)</code> doesn’t make sense, stop and think about what’s going on… For each value in the prior distribution <code>priordist</code> (continuous values 0 to 1 generated from the beta distribution reflecting Doctor X’s prior beliefs), we simulated (randomly generated) data from a binomial distribution with 100 patients (<code>size = n_patient</code>) and a specific survival probability (0.135026 in the first simulation).</p>
<h2 id="identify-samples-that-match-our-observed-outcome">Identify samples that match our observed outcome</h2>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
sim_equals_observed_boolean &lt;- simulated_data == 72 # &quot;combine&quot; prior with data
head(sim_equals_observed_boolean)</code></pre>
<pre><code>
[1] FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
</div>
<h2 id="identify-prior-samples-associated-with-samples-that-match-observed-outcome-to-get-the-posterior">Identify prior samples associated with samples that match observed outcome to get the posterior!</h2>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
posterior &lt;- priordist[sim_equals_observed_boolean] # &quot;combine&quot; prior with data
length(posterior)</code></pre>
<pre><code>
[1] 385</code></pre>
<pre class="r"><code>
head(posterior)</code></pre>
<pre><code>
[1] 0.8121576 0.6988426 0.7485535 0.7429733 0.7144441 0.7295646</code></pre>
</div>
<p>Yes, this posterior is the Bayesian posterior, <span class="math inline">\(P(\theta|data)\)</span>, the probability of your theory given the data, or Doctor X’s updated/revised beliefs! We have combined the prior, <span class="math inline">\(P(\theta)\)</span> with the likelihood, <span class="math inline">\(P(data|\theta)\)</span> to get the posterior, <span class="math inline">\(P(\theta|data)\)</span>. Below is Bayes’ theorem:</p>
<aside>
We ignore the marginal, <span class="math inline">\(P(data)\)</span>, in our example, since it’s not needed for rejection sampling. Actual MCMC algorithms also don’t try to estimate this term, because it’s very difficult!
</aside>
<p><span class="math display">\[P(\theta|data) = \frac{P(data|\theta)P(\theta)}{P(data)}\]</span></p>
<p><strong>Rejection sampling</strong>: Note that we have only 385 samples in our posterior distribution, even though we started off with 20000 samples in the prior! We have rejected all the prior samples that fail to generate 72 survivals (observed outcome) during our simulations. Hence the term <strong>“rejection sampling”</strong>. Rejection sampling is highly inefficient because we reject or throw out many samples! In practice, we never use rejection sampling, but it’s good to illustrate MCMC principles and how sampling works to combine the prior with the data to produce the posterior.</p>
<h2 id="summarize-posterior-samples">Summarize posterior samples</h2>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
mean(posterior)</code></pre>
<pre><code>
[1] 0.7213848</code></pre>
<pre class="r"><code>
median(posterior)</code></pre>
<pre><code>
[1] 0.7189539</code></pre>
<pre class="r"><code>
quantile(posterior, c(0.025, 0.975))</code></pre>
<pre><code>
     2.5%     97.5% 
0.6285226 0.8117400 </code></pre>
</div>
<h2 id="compare-prior-and-posterior">Compare prior and posterior</h2>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
hist(priordist, main = paste0(&quot;Doctor X&#39;s prior&quot;, &quot; (prior samples = &quot;, length(priordist), &quot;)&quot;), 
     xlab = &quot;Plausible probability values&quot;, ylab = &quot;Count&quot;, xlim = c(0, 1))
abline(v = 0.83, col = &quot;black&quot;, lwd = 3)</code></pre>
<p><img src="gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/figure-html5/unnamed-chunk-14-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
hist(posterior, main = paste0(&quot;Posterior&quot;, &quot; (n = &quot;, length(posterior), &quot;)&quot;), 
     xlab = &quot;Plausible probability values&quot;, ylab = &quot;Count&quot;, xlim = c(0, 1))
abline(v = mean(posterior), col = &quot;blue&quot;, lwd = 5)
abline(v = quantile(posterior, c(0.025, 0.975))[1], col = &quot;blue&quot;, lwd = 1)
abline(v = quantile(posterior, c(0.025, 0.975))[2], col = &quot;blue&quot;, lwd = 1)</code></pre>
<p><img src="gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/figure-html5/unnamed-chunk-15-1.png" width="624" /></p>
</div>
<h2 id="create-a-simple-function-for-further-simulations-and-exploration">Create a simple function for further simulations and exploration</h2>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
posterior_from_prior &lt;- function(total_patients, total_survive, 
                                 prior_samples, prior_beta_shape1 = 1, prior_beta_shape2 = 1) {
  survive_propr &lt;- total_survive/total_patients
  priordist &lt;- rbeta(n = prior_samples, shape1 = prior_beta_shape1, shape2 = prior_beta_shape2)
  simulated_data &lt;- rbinom(n = length(priordist), size = total_patients, prob = priordist)
  posterior &lt;- priordist[simulated_data == total_survive]

  par(mfrow = c(1, 2))
  hist(priordist, main = paste0(&quot;Prior&quot;, &quot; (N = &quot;, length(priordist), &quot;)&quot;), 
       xlab = &quot;Plausible probability values&quot;, ylab = &quot;Count&quot;, xlim = c(0, 1))
  abline(v = mean(priordist), col = &quot;black&quot;, lwd = 3)
  hist(posterior, main = paste0(&quot;Posterior&quot;, &quot; (n = &quot;, length(posterior), &quot;)&quot;), 
       xlab = &quot;Plausible probability values&quot;, ylab = &quot;Count&quot;, xlim = c(0, 1))
  abline(v = survive_propr, col = &quot;red&quot;, lwd = 3)
  abline(v = mean(posterior), col = &quot;blue&quot;, lwd = 5)
  abline(v = quantile(posterior, c(0.025, 0.975))[1], col = &quot;blue&quot;, lwd = 1)
  abline(v = quantile(posterior, c(0.025, 0.975))[2], col = &quot;blue&quot;, lwd = 1)
  print(paste0(&quot;posterior mean: &quot;, round(mean(posterior), 2)))
  print(paste0(&quot;posterior median: &quot;, round(median(posterior), 2)))
  par(mfrow = c(1, 1))
}</code></pre>
</div>
<h2 id="exploring-different-parameters-sample-size-prior-shapes">Exploring different parameters (sample size, prior shapes)</h2>
<p>Try different parameters yourself to get a better sense of how things work.</p>
<p>Line colors</p>
<ul>
<li>black: prior mean</li>
<li>blue: posterior mean (thin blue lines are 2.5% and 97.5% intervals)</li>
<li>red: observed value/data</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
posterior_from_prior(total_patients = 50, total_survive = 10, 
                     prior_samples = 20000, 
                     prior_beta_shape1 = 0.5, prior_beta_shape2 = 0.5)</code></pre>
<p><img src="gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/figure-html5/unnamed-chunk-17-1.png" width="624" /></p>
<pre><code>
[1] &quot;posterior mean: 0.21&quot;
[1] &quot;posterior median: 0.2&quot;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
posterior_from_prior(total_patients = 100, total_survive = 70, 
                     prior_samples = 20000, 
                     prior_beta_shape1 = 0.1, prior_beta_shape2 = 0.9)</code></pre>
<p><img src="gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/figure-html5/unnamed-chunk-18-1.png" width="624" /></p>
<pre><code>
[1] &quot;posterior mean: 0.69&quot;
[1] &quot;posterior median: 0.7&quot;</code></pre>
</div>
<p>Despite the skewed prior, the posterior distribution reflects the true value (<code>70/100 = 0.7</code>), but note how few samples we have in the posterior distribution!</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
posterior_from_prior(total_patients = 10, total_survive = 7, 
                     prior_samples = 20000, 
                     prior_beta_shape1 = 1.0, prior_beta_shape2 = 5.0)</code></pre>
<p><img src="gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc_files/figure-html5/unnamed-chunk-19-1.png" width="624" /></p>
<pre><code>
[1] &quot;posterior mean: 0.51&quot;
[1] &quot;posterior median: 0.5&quot;</code></pre>
</div>
<p>This time, notice how the terribly skewed prior prevents the sampler from properly “exploring” the full range of the posterior distribution, which doesn’t capture the data well (<code>7/10 = 0.7 survival</code>).</p>
<!--radix_placeholder_article_footer-->
<div class="article-footer">
  <p class="social_footer">
    <span class="disqus-comments">
      <i class="fas fa-comments"></i>
      &nbsp;
      <span class="disqus-comment-count" data-disqus-identifier="posts/2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc/">Comment on this article</span>
    </span>
    <span class="article-sharing">
      Share: &nbsp;
      <a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p[url]=https%3A%2F%2Fhausetutorials.netlify.com%2Fposts%2F2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc%2F">
        <i class="fab fa-facebook"></i>
      </a>
      <a href="https://twitter.com/share?text=Bayesian%20inference%20and%20MCMC%20sampling%20introduction&amp;url=https%3A%2F%2Fhausetutorials.netlify.com%2Fposts%2F2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc%2F">
        <i class="fab fa-twitter"></i>
      </a>
      <a href="https://plus.google.com/share?url=https%3A%2F%2Fhausetutorials.netlify.com%2Fposts%2F2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc%2F">
        <i class="fab fa-google-plus"></i>
      </a>
      <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fhausetutorials.netlify.com%2Fposts%2F2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc%2F&amp;title=Bayesian%20inference%20and%20MCMC%20sampling%20introduction">
        <i class="fab fa-linkedin"></i>
      </a>
    </span>
  </p>
  <script id="dsq-count-scr" src="https://data-science-with-r-for-experimental-psychologists.disqus.com/count.js" async></script>
  <div id="disqus_thread" class="hidden"></div>
  <script>
var disqus_config = function () {
  this.page.url = 'https://hausetutorials.netlify.com/posts/2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc/';
  this.page.identifier = 'posts/2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc/';
};
(function() {
  var d = document, s = d.createElement('script');
  s.src = 'https://data-science-with-r-for-experimental-psychologists.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();
</script>
</div>
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="updates-and-corrections">Corrections</h3>
  <p>If you see mistakes or want to suggest changes, please <a href="https://github.com/hauselin/rtutorialsite/blob/master/_posts/2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc/gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc.Rmd/issues/new">create an issue</a> on the source repository.</p>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Source code is available at <a href="https://github.com/hauselin/rtutorialsite/blob/master/_posts/2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc/gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc.Rmd">https://github.com/hauselin/rtutorialsite/blob/master/_posts/2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc/gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc.Rmd</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Lin (2019, April 9). Data science with R: Bayesian inference and MCMC sampling introduction. Retrieved from https://hausetutorials.netlify.com/posts/2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{lin2019bayesian,
  author = {Lin, Hause},
  title = {Data science with R: Bayesian inference and MCMC sampling introduction},
  url = {https://hausetutorials.netlify.com/posts/2019-04-09-gentle-and-intuitive-intro-to-markov-chain-monte-carlo-mcmc/},
  year = {2019}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<div class="radix-site-nav radix-site-footer">
  <p>Created and managed by <a href="mailto:hauselin@gmail.com">Hause Lin</a></p>
  <p>Created with <a href="https://rstudio.github.io/radix/" target="_blank" rel="noopener noreferrer">Radix</a> in <a href="https://www.rstudio.com/" target="_blank" rel="noopener noreferrer">RStudio</a></p>
</div>
<!--/radix_placeholder_navigation_after_body-->


</body>

</html>
