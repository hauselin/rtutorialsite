<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="radix" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

  <!--radix_placeholder_meta_tags-->
<title>Data science: Complete vs. partial vs. no-pooling: Fit the same model to different groups (just one simple line of code)</title>

<meta property="description" itemprop="description" content="What is complete pooling, no-pooling, and partial pooling, and how to use data.table for no-pooling models (fit the same model, but separately to each group)"/>

<link rel="canonical" href="https://hausetutorials.netlify.com/posts/2019-02-18-fit-models-to-every-group/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2019-02-18"/>
<meta property="article:created" itemprop="dateCreated" content="2019-02-18"/>
<meta name="article:author" content="Hause Lin"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Data science: Complete vs. partial vs. no-pooling: Fit the same model to different groups (just one simple line of code)"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="What is complete pooling, no-pooling, and partial pooling, and how to use data.table for no-pooling models (fit the same model, but separately to each group)"/>
<meta property="og:url" content="https://hausetutorials.netlify.com/posts/2019-02-18-fit-models-to-every-group/"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Data science"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="Data science: Complete vs. partial vs. no-pooling: Fit the same model to different groups (just one simple line of code)"/>
<meta property="twitter:description" content="What is complete pooling, no-pooling, and partial pooling, and how to use data.table for no-pooling models (fit the same model, but separately to each group)"/>
<meta property="twitter:url" content="https://hausetutorials.netlify.com/posts/2019-02-18-fit-models-to-every-group/"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Data science: Complete vs. partial vs. no-pooling: Fit the same model to different groups (just one simple line of code)"/>
<meta name="citation_fulltext_html_url" content="https://hausetutorials.netlify.com/posts/2019-02-18-fit-models-to-every-group/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2019/02/18"/>
<meta name="citation_publication_date" content="2019/02/18"/>
<meta name="citation_author" content="Hause Lin"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Regression analyses of repeated measures data in cognitive research.;citation_publication_date=1990;citation_volume=16;citation_author=Robert F. Lorch;citation_author=Jerome L. Myers"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["creative_commons","title","description","author","date","output","draft","categories","repository_url","bibliography","editor_options","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["Complete vs. partial vs. no-pooling: Fit the same model to different groups (just one simple line of code)"]},{"type":"character","attributes":{},"value":["What is complete pooling, no-pooling, and partial pooling, and how to use data.table for no-pooling models (fit the same model, but separately to each group)"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Hause Lin"]}]}]},{"type":"character","attributes":{},"value":["02-18-2019"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["radix::radix_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["data.table","pooling","hausekeep"]},{"type":"character","attributes":{},"value":["https://github.com/hauselin/rtutorialsite"]},{"type":"character","attributes":{},"value":["biblio.bib"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["chunk_output_type"]}},"value":[{"type":"character","attributes":{},"value":["console"]}]},{"type":"character","attributes":{},"value":["https://hausetutorials.netlify.com/posts/2019-02-18-fit-models-to-every-group/"]},{"type":"character","attributes":{},"value":["https://hausetutorials.netlify.com/posts/2019-02-18-fit-models-to-every-group/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["biblio.bib","fit-models-to-every-group_files/bowser-1.9.3/bowser.min.js","fit-models-to-every-group_files/distill-2.2.21/template.v2.js","fit-models-to-every-group_files/jquery-1.11.3/jquery.min.js","fit-models-to-every-group_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.radix-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.radix-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #455a64;
  font-size: 15px;
  font-weight: 300;
}

.radix-site-nav a {
  color: inherit;
  text-decoration: none;
}

.radix-site-nav a:hover {
  color: white;
}

@media print {
  .radix-site-nav {
    display: none;
  }
}

.radix-site-header {

}

.radix-site-footer {

}


/* Site Header */

.radix-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.radix-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .radix-site-header .nav-left {
    margin-left: 0;
  }
}


.radix-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.radix-site-header a,
.radix-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.radix-site-header .title {
  font-size: 18px;
}

.radix-site-header .logo {
  padding: 0;
}

.radix-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.radix-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .radix-site-header .logo img {
    display: inline-block;
  }
  .radix-site-header .nav-left {
    margin-left: 20px;
  }
  .radix-site-header .nav-right {
    margin-right: 20px;
  }
  .radix-site-header .title {
    padding-left: 12px;
  }
}


.radix-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .radix-site-header a, .radix-site-header .nav-dropdown  {display: none;}
  .radix-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .radix-site-header .title {
    margin-left: 0;
  }
  .radix-site-header .nav-right {
    margin-right: 0;
  }
  .radix-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .radix-site-header.responsive {position: relative;}
  .radix-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .radix-site-header.responsive a,
  .radix-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .radix-site-header.responsive .nav-left,
  .radix-site-header.responsive .nav-right {
    width: 100%;
  }
  .radix-site-header.responsive .nav-dropdown {float: none;}
  .radix-site-header.responsive .nav-dropdown-content {position: relative;}
  .radix-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.radix-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

</style>

<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for table of contents */

.d-toc {
  color: rgba(0,0,0,0.8);
  font-size: 0.8em;
  line-height: 1em;
}

.d-toc-header {
  font-size: 0.6rem;
  font-weight: 400;
  color: rgba(0, 0, 0, 0.5);
  text-transform: uppercase;
  margin-top: 0;
  margin-bottom: 1.3em;
}

.d-toc a {
  border-bottom: none;
}

.d-toc ul {
  padding-left: 0;
}

.d-toc li>ul {
  padding-top: 0.8em;
  padding-left: 16px;
  margin-bottom: 0.6em;
}

.d-toc ul,
.d-toc li {
  list-style-type: none;
}

.d-toc li {
  margin-bottom: 0.9em;
}

.d-toc-separator {
  margin-top: 20px;
  margin-bottom: 2em;
}

.d-article-with-toc {
  border-top: none;
  padding-top: 0;
}



/* Tweak code blocks (note that this CSS is repeated above in an injection
   into the d-code shadow dom) */

d-code {
  overflow-x: auto !important;
}

pre.d-code code.d-code {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

pre.text-output {

  font-size: 12px;
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

@media(min-width: 768px) {

d-code {
  overflow-x: visible !important;
}

pre.d-code code.d-code  {
    padding-left: 18px;
    font-size: 14px;
}
pre.text-output {
  font-size: 14px;
}
}

/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}



/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}


/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // create d-bibliography
  var bibliography = $('<d-bibliography></d-bibliography>');
  $('#distill-bibliography').wrap(bibliography);

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace citations with <d-cite>
  $('.citation').each(function(i, val) {
    appendix = true;
    var cites = $(this).attr('data-cites').split(" ");
    var dt_cite = $('<d-cite></d-cite>');
    dt_cite.attr('key', cites.join());
    $(this).replaceWith(dt_cite);
  });
  // remove refs
  $('#refs').remove();

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-toc a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // replace code blocks with d-code
  $('pre>code').each(function(i, val) {
    var code = $(this);
    var pre = code.parent();
    var clz = "";
    var language = pre.attr('class');
    if (language) {
      // map unknown languages to "clike" (without this they just dissapear)
      if ($.inArray(language, ["bash", "clike", "css", "go", "html",
                               "javascript", "js", "julia", "lua", "markdown",
                               "markup", "mathml", "python", "svg", "xml"]) == -1)
        language = "clike";
      language = ' language="' + language + '"';
      var dt_code = $('<d-code block' + language + clz + '></d-code>');
      dt_code.text(code.text());
      pre.replaceWith(dt_code);
    } else {
      code.addClass('text-output').unwrap().changeElementType('pre');
    }
  });

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('d-code, pre.text-output, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // table of contents
    if (have_authors) // adjust border if we are in authors
      $('.d-toc').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // inject pre code styles (can't do this with a global stylesheet b/c a shadow root is used)
    $('d-code').each(function(i, val) {
      var style = document.createElement('style');
      style.innerHTML = 'pre code { padding-left: 10px; font-size: 12px; border-left: 2px solid rgba(0,0,0,0.1); } ' +
                        '@media(min-width: 768px) { pre code { padding-left: 18px; font-size: 14px; } }';
      if (this.shadowRoot)
        this.shadowRoot.appendChild(style);
    });

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-toc-header').remove();
  $('.d-toc').remove();
  $('.d-toc-separator').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.radix-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-134721506-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-134721506-5');
</script>
<style type="text/css">
.radix-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #383838;
  font-size: 15px;
  font-weight: 300;
}

</style>
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Complete vs. partial vs. no-pooling: Fit the same model to different groups (just one simple line of code)","description":"What is complete pooling, no-pooling, and partial pooling, and how to use data.table for no-pooling models (fit the same model, but separately to each group)","authors":[{"author":"Hause Lin","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#"}],"publishedDate":"2019-02-18T00:00:00.000-05:00","citationText":"Lin, 2019"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="radix-site-nav radix-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">Data science</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="https://www.hauselin.com/about/">About me</a>
<a href="http://escal.site">Effect size converter</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Tutorials
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="../../0000_install.html">Install R and packages</a>
<a href="../../0001_rbasics.html">R programming basics</a>
<a href="../../0002_tidyverse_datatable.html">tidyverse and data.table</a>
<a href="../../0003_ggplot_modelfitting.html">ggplot and model fitting</a>
<a href="../../0004_dataform_join.html">long/wide form data and joining</a>
<a href="../../0005_analyze_multi_subject_trial_data.html">analyze multi-subject/trial RT data</a>
</div>
</div>
<a href="../../articles.html">Articles</a>
<a href="https://donorbox.org/support-my-teaching">Donate</a>
<a href="https://twitter.com/hauselin">
<i class="fab fa-twitter"></i>
</a>
<a href="https://github.com/hauselin/rtutorialsite">
<i class="fab fa-github"></i>
</a>
<a href="https://scholar.google.ca/citations?user=4_ZopI0AAAAJ&amp;hl=en">
<i class="fab fa-google"></i>
</a>
<a href="../../articles.xml">
<i class="fa fa-rss"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Complete vs. partial vs. no-pooling: Fit the same model to different groups (just one simple line of code)</h1>
<p>What is complete pooling, no-pooling, and partial pooling, and how to use data.table for no-pooling models (fit the same model, but separately to each group)</p>
</div>

<div class="d-byline">
  Hause Lin  
  
<br/>02-18-2019
</div>

<div class="d-article">
<h3 class="d-toc-header">Table of Contents</h3>
<nav class="d-toc" id="TOC">
<ul>
<li><a href="#consider-being-a-patron-and-supporting-my-work">Consider being a patron and supporting my work?</a></li>
<li><a href="#how-to-use-data.table-package-to-repeatedly-fit-a-model-to-separate-groups-in-a-dataset">How to use <code>data.table</code> package to repeatedly fit a model to separate groups in a dataset</a></li>
<li><a href="#completing-pooling-approach">Completing pooling approach</a></li>
<li><a href="#partial-pooling-approach">Partial pooling approach</a></li>
<li><a href="#no-pooling-approach">No pooling approach</a></li>
<li><a href="#support-my-work">Support my work</a></li>
</ul>
</nav>
<hr class="d-toc-separator"/>
<p>Get source code for this RMarkdown script <a href="https://github.com/hauselin/rtutorialsite/blob/master/_posts/2019-02-18-fit-models-to-every-group/fit-models-to-every-group.Rmd">here</a>.</p>
<h2 id="consider-being-a-patron-and-supporting-my-work">Consider being a patron and supporting my work?</h2>
<p><a href="https://donorbox.org/support-my-teaching">Donate and become a patron</a>: If you find value in what I do and have learned something from my site, please consider becoming a patron. It takes me many hours to research, learn, and put together tutorials. Your support really matters.</p>
<h2 id="how-to-use-data.table-package-to-repeatedly-fit-a-model-to-separate-groups-in-a-dataset">How to use <code>data.table</code> package to repeatedly fit a model to separate groups in a dataset</h2>
<p>Before the invention of multi-level models (aka linear mixed effects models), how did people analyze nested or repeated-measures data? They aggregated the data, used repeated-measures ANOVA, and did other things.</p>
<p>One interesting approach is to repeatedly fit the same model to each group separately, and this approach seems to be first mentioned in this article <span class="citation" data-cites="Lorch">(Lorch and Myers <a href="#ref-Lorch">1990</a>)</span>. If you have 10 data points per subject, you have nested data (data points nested within subjects), and you could fit 10 linear regressions, one for each subject. This approach is still quite useful nowadays (I use it regularly in my research), and I’ll demonstrate how to do it easily with <code>data.table</code> and my <code>summaryh()</code> function from my <code>hausekeep</code> package.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
# load packages
library(hausekeep); library(data.table)</code></pre>
</div>
<p>Convert the built-in dataset <code>ChickWeight</code> to <code>data.table</code> class so we can leverage its extensive functionalities.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
dt1 &lt;- data.table(ChickWeight) # convert builtin dataset to data.table class
dt1 # print dataset </code></pre>
<pre><code>
     weight Time Chick Diet
  1:     42    0     1    1
  2:     51    2     1    1
  3:     59    4     1    1
  4:     64    6     1    1
  5:     76    8     1    1
 ---                       
574:    175   14    50    4
575:    205   16    50    4
576:    234   18    50    4
577:    264   20    50    4
578:    264   21    50    4</code></pre>
</div>
<aside>
Dataset contains weights of 50 chicks that were fed one of four diets. Their weights were tracked over time. Type <code>?ChickWeight</code> in the console for more info about this dataset.
</aside>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
summary(dt1) # check dataset</code></pre>
<pre><code>
     weight           Time           Chick     Diet   
 Min.   : 35.0   Min.   : 0.00   13     : 12   1:220  
 1st Qu.: 63.0   1st Qu.: 4.00   9      : 12   2:120  
 Median :103.0   Median :10.00   20     : 12   3:120  
 Mean   :121.8   Mean   :10.72   10     : 12   4:118  
 3rd Qu.:163.8   3rd Qu.:16.00   17     : 12          
 Max.   :373.0   Max.   :21.00   19     : 12          
                                 (Other):506          </code></pre>
<pre class="r"><code>
dt1[, Chick := as.numeric(as.character(Chick))] # recode factor as numeric</code></pre>
</div>
<h2 id="completing-pooling-approach">Completing pooling approach</h2>
<p>Let’s look at just the first 10 chicks (and to illustrate <code>data.table</code> syntax; see my <a href="https://hausetutorials.netlify.com/0002_tidyverse_datatable.html">data.table</a> tutorials). We then fit a linear regression <code>weight ~ Time</code> to the data from these 10 chicks, ignoring that the data came from 10 different chicks (i.e., completing pooling). That is, we pretend all the data came from one chick.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
# filter rows where Chick is &lt;= 10 and fit linear regression model
dt1[Chick &lt;= 10, ] # syntax works only with data.table</code></pre>
<pre><code>
     weight Time Chick Diet
  1:     42    0     1    1
  2:     51    2     1    1
  3:     59    4     1    1
  4:     64    6     1    1
  5:     76    8     1    1
 ---                       
115:     96   14    10    1
116:    101   16    10    1
117:    112   18    10    1
118:    120   20    10    1
119:    124   21    10    1</code></pre>
<pre class="r"><code>
model &lt;- lm(weight ~ Time, data = dt1[Chick &lt;= 10])
summary(model)</code></pre>
<pre><code>
Call:
lm(formula = weight ~ Time, data = dt1[Chick &lt;= 10])

Residuals:
    Min      1Q  Median      3Q     Max 
-85.907 -11.399  -1.485  11.291 121.093 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  30.2094     5.2189   5.788 6.07e-08 ***
Time          7.3189     0.4091  17.892  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 30.08 on 117 degrees of freedom
Multiple R-squared:  0.7323,    Adjusted R-squared:   0.73 
F-statistic: 320.1 on 1 and 117 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<p>If you use <code>summaryh()</code> from my <a href="https://hauselin.github.io/hausekeep/reference/summaryh.html">hausekeep package</a>, you can show formatted output that can be copied-pasted into your APA manuscript.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
summaryh(model) </code></pre>
<pre><code>
          term                                                 results
1: (Intercept) b = 30.21, SE = 5.22, t(117) = 5.79, p &lt; .001, r = 0.47
2:        Time b = 7.32, SE = 0.41, t(117) = 17.89, p &lt; .001, r = 0.86</code></pre>
</div>
<p>Or fit the same model within <code>data.table</code></p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
dt1[Chick &lt;= 10, summaryh(lm(weight ~ Time))] # results are same as above</code></pre>
<pre><code>
          term                                                 results
1: (Intercept) b = 30.21, SE = 5.22, t(117) = 5.79, p &lt; .001, r = 0.47
2:        Time b = 7.32, SE = 0.41, t(117) = 17.89, p &lt; .001, r = 0.86</code></pre>
</div>
<aside>
<code>summaryh()</code> returns results in a <code>data.table</code>.
</aside>
<h2 id="partial-pooling-approach">Partial pooling approach</h2>
<p>The more appropriate way to fit this model is to account for the nested structure is to use linear mixed models (lme4 package). This approach is ‘partial pooling’, because it assumes hierarchy in the data structure.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
library(lme4); library(lmerTest)
lme1 &lt;- lmer(weight ~ Time + (1 | Chick), data = dt1[Chick %in% 1:10])
summaryh(lme1)</code></pre>
<pre><code>
          term                                                 results
1: (Intercept)  b = 30.33, SE = 7.39, t(15) = 4.10, p = .001, r = 0.73
2:        Time b = 7.30, SE = 0.32, t(108) = 22.74, p &lt; .001, r = 0.91</code></pre>
<pre class="r"><code>
summary(lme1)</code></pre>
<pre><code>
Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [&#39;lmerModLmerTest&#39;]
Formula: weight ~ Time + (1 | Chick)
   Data: dt1[Chick %in% 1:10]

REML criterion at convergence: 1104.9

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.5405 -0.5187 -0.0682  0.6075  3.6354 

Random effects:
 Groups   Name        Variance Std.Dev.
 Chick    (Intercept) 378.8    19.46   
 Residual             556.4    23.59   
Number of obs: 119, groups:  Chick, 10

Fixed effects:
            Estimate Std. Error      df t value Pr(&gt;|t|)    
(Intercept)   30.329      7.392  14.747   4.103 0.000972 ***
Time           7.300      0.321 108.052  22.741  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
     (Intr)
Time -0.470</code></pre>
</div>
<h2 id="no-pooling-approach">No pooling approach</h2>
<p>What if you want to fit a separate model for each chick/group, so you know how time was associated with weight for each chick? You could write a for loop to loop through each chick, but you can do it with <code>data.table</code> syntax really easily.</p>
<p>Now we can extend the syntax above with <code>by = Chick</code> to fit the model to each chick! Just one line of code is needed.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
# fit linear regression model to first 10 Chicks
dt1[Chick %in% 1:10, summaryh(lm(weight ~ Time)), by = Chick]</code></pre>
<pre><code>
    Chick        term                                                 results
 1:     1 (Intercept)  b = 24.47, SE = 6.73, t(10) = 3.64, p = .005, r = 0.75
 2:     1        Time  b = 7.99, SE = 0.52, t(10) = 15.25, p &lt; .001, r = 0.98
 3:     2 (Intercept)  b = 24.72, SE = 4.93, t(10) = 5.01, p &lt; .001, r = 0.85
 4:     2        Time  b = 8.72, SE = 0.38, t(10) = 22.72, p &lt; .001, r = 0.99
 5:     3 (Intercept)  b = 23.18, SE = 5.08, t(10) = 4.56, p = .001, r = 0.82
 6:     3        Time  b = 8.49, SE = 0.40, t(10) = 21.45, p &lt; .001, r = 0.99
 7:     4 (Intercept)  b = 32.87, SE = 4.01, t(10) = 8.21, p &lt; .001, r = 0.93
 8:     4        Time  b = 6.09, SE = 0.31, t(10) = 19.53, p &lt; .001, r = 0.99
 9:     5 (Intercept)  b = 16.90, SE = 7.56, t(10) = 2.24, p = .049, r = 0.58
10:     5        Time b = 10.06, SE = 0.59, t(10) = 17.10, p &lt; .001, r = 0.98
11:     6 (Intercept)  b = 44.12, SE = 7.35, t(10) = 6.00, p &lt; .001, r = 0.88
12:     6        Time  b = 6.38, SE = 0.57, t(10) = 11.15, p &lt; .001, r = 0.96
13:     7 (Intercept)  b = 5.84, SE = 11.42, t(10) = 0.51, p = .620, r = 0.16
14:     7        Time b = 13.21, SE = 0.89, t(10) = 14.85, p &lt; .001, r = 0.98
15:     8 (Intercept)  b = 43.73, SE = 3.70, t(9) = 11.82, p &lt; .001, r = 0.97
16:     8        Time   b = 4.83, SE = 0.31, t(9) = 15.44, p &lt; .001, r = 0.98
17:     9 (Intercept) b = 52.09, SE = 4.79, t(10) = 10.88, p &lt; .001, r = 0.96
18:     9        Time   b = 2.66, SE = 0.37, t(10) = 7.15, p &lt; .001, r = 0.91
19:    10 (Intercept) b = 38.70, SE = 1.13, t(10) = 34.28, p &lt; .001, r = 1.00
20:    10        Time  b = 4.07, SE = 0.09, t(10) = 46.29, p &lt; .001, r = 1.00</code></pre>
</div>
<aside>
When calling functions inside a <code>data.table</code> with the <code>by</code> argument, your functions have to return vectors, lists, or dataframes. Otherwise, you’ll get error messages. Run the code below to figure out why.
</aside>
<p>Return specific results (e.g., t, p, SE, beta) in separate columns</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
dt1[Chick %in% 1:10, summaryh(lm(weight ~ Time), showTable = T)$results2, by = Chick]</code></pre>
<pre><code>
    Chick        term estimate std.error df statistic p.value  es.r   es.d es.r.squared es.adj.r.squared
 1:     1 (Intercept)   24.465     6.728 10     3.636   0.005 0.755  2.300        0.959            0.955
 2:     1        Time    7.988     0.524 10    15.255   0.000 0.979  9.648        0.959            0.955
 3:     2 (Intercept)   24.725     4.931 10     5.014   0.001 0.846  3.171        0.981            0.979
 4:     2        Time    8.720     0.384 10    22.721   0.000 0.990 14.370        0.981            0.979
 5:     3 (Intercept)   23.180     5.083 10     4.560   0.001 0.822  2.884        0.979            0.977
 6:     3        Time    8.487     0.396 10    21.455   0.000 0.989 13.569        0.979            0.977
 7:     4 (Intercept)   32.866     4.005 10     8.206   0.000 0.933  5.190        0.974            0.972
 8:     4        Time    6.089     0.312 10    19.532   0.000 0.987 12.353        0.974            0.972
 9:     5 (Intercept)   16.896     7.556 10     2.236   0.049 0.577  1.414        0.967            0.964
10:     5        Time   10.055     0.588 10    17.098   0.000 0.983 10.814        0.967            0.964
11:     6 (Intercept)   44.123     7.351 10     6.002   0.000 0.885  3.796        0.926            0.918
12:     6        Time    6.378     0.572 10    11.147   0.000 0.962  7.050        0.926            0.918
13:     7 (Intercept)    5.843    11.422 10     0.512   0.620 0.160  0.324        0.957            0.952
14:     7        Time   13.205     0.889 10    14.855   0.000 0.978  9.395        0.957            0.952
15:     8 (Intercept)   43.727     3.698  9    11.824   0.000 0.969  7.882        0.964            0.960
16:     8        Time    4.827     0.313  9    15.444   0.000 0.982 10.296        0.964            0.960
17:     9 (Intercept)   52.094     4.786 10    10.885   0.000 0.960  6.884        0.836            0.820
18:     9        Time    2.663     0.372 10     7.150   0.000 0.915  4.522        0.836            0.820
19:    10 (Intercept)   38.695     1.129 10    34.285   0.000 0.996 21.684        0.995            0.995
20:    10        Time    4.066     0.088 10    46.289   0.000 0.998 29.276        0.995            0.995</code></pre>
</div>
<aside>
This line of code might look complicated, but it’s actually quite easy if you understand how the <code>summaryh()</code> function works. See <a href="https://hauselin.github.io/hausekeep/reference/summaryh.html">here</a> for documentation.
</aside>
<p>Why won’t <code>summary()</code> work?</p>
<pre class="{r"><code>
dt1[Chick &lt;= 10, summary(lm(weight ~ Time))] # summary() doesn&#39;t return a table
dt1[Chick &lt;= 10, summary(lm(weight ~ Time)), by = Chick] # doesn&#39;t work! </code></pre>
<p>You can also use the <code>lmList()</code> function from the <code>lme4</code> package to fit this ‘no-pooling’ model, but you don’t get p-values, effect sizes, and other useful information!</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
lmList(weight ~ Time | Chick, data = dt1[Chick &lt;= 10])</code></pre>
<pre><code>
Call: lmList(formula = weight ~ Time | Chick, data = dt1[Chick &lt;= 10]) 
Coefficients:
   (Intercept)      Time
1    24.465436  7.987899
2    24.724853  8.719861
3    23.179549  8.487370
4    32.865678  6.088640
5    16.895628 10.055362
6    44.123431  6.378006
7     5.842535 13.205264
8    43.727273  4.827273
9    52.094086  2.663137
10   38.695054  4.066102

Degrees of freedom: 119 total; 99 residual
Residual standard error: 11.44853</code></pre>
</div>
<h2 id="support-my-work">Support my work</h2>
<p><a href="https://donorbox.org/support-my-teaching">Support my work and become a patron here</a>!</p>
<div id="refs" class="references">
<div id="ref-Lorch">
<p>Lorch, Robert F., and Jerome L. Myers. 1990. “Regression Analyses of Repeated Measures Data in Cognitive Research.” <em>Journal of Experimental Psychology: Learning, Memory, and Cognition</em> 16 (1): 149–57. <a href="https://www.ncbi.nlm.nih.gov/pubmed/2136750">https://www.ncbi.nlm.nih.gov/pubmed/2136750</a>.</p>
</div>
</div>
<!--radix_placeholder_article_footer-->
<div class="article-footer">
  <p class="social_footer">
    <span class="disqus-comments">
      <i class="fas fa-comments"></i>
      &nbsp;
      <span class="disqus-comment-count" data-disqus-identifier="posts/2019-02-18-fit-models-to-every-group/">Comment on this article</span>
    </span>
    <span class="article-sharing">
      Share: &nbsp;
      <a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p[url]=https%3A%2F%2Fhausetutorials.netlify.com%2Fposts%2F2019-02-18-fit-models-to-every-group%2F">
        <i class="fab fa-facebook"></i>
      </a>
      <a href="https://twitter.com/share?text=Complete%20vs.%20partial%20vs.%20no-pooling%3A%20Fit%20the%20same%20model%20to%20different%20groups%20%28just%20one%20simple%20line%20of%20code%29&amp;url=https%3A%2F%2Fhausetutorials.netlify.com%2Fposts%2F2019-02-18-fit-models-to-every-group%2F">
        <i class="fab fa-twitter"></i>
      </a>
      <a href="https://plus.google.com/share?url=https%3A%2F%2Fhausetutorials.netlify.com%2Fposts%2F2019-02-18-fit-models-to-every-group%2F">
        <i class="fab fa-google-plus"></i>
      </a>
      <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fhausetutorials.netlify.com%2Fposts%2F2019-02-18-fit-models-to-every-group%2F&amp;title=Complete%20vs.%20partial%20vs.%20no-pooling%3A%20Fit%20the%20same%20model%20to%20different%20groups%20%28just%20one%20simple%20line%20of%20code%29">
        <i class="fab fa-linkedin"></i>
      </a>
    </span>
  </p>
  <script id="dsq-count-scr" src="https://data-science-with-r-for-experimental-psychologists.disqus.com/count.js" async></script>
  <div id="disqus_thread" class="hidden"></div>
  <script>
var disqus_config = function () {
  this.page.url = 'https://hausetutorials.netlify.com/posts/2019-02-18-fit-models-to-every-group/';
  this.page.identifier = 'posts/2019-02-18-fit-models-to-every-group/';
};
(function() {
  var d = document, s = d.createElement('script');
  s.src = 'https://data-science-with-r-for-experimental-psychologists.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();
</script>
</div>
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="updates-and-corrections">Corrections</h3>
  <p>If you see mistakes or want to suggest changes, please <a href="https://github.com/hauselin/rtutorialsite/issues/new">create an issue</a> on the source repository.</p>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Source code is available at <a href="https://github.com/hauselin/rtutorialsite">https://github.com/hauselin/rtutorialsite</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Lin (2019, Feb. 18). Data science: Complete vs. partial vs. no-pooling: Fit the same model to different groups (just one simple line of code). Retrieved from https://hausetutorials.netlify.com/posts/2019-02-18-fit-models-to-every-group/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{lin2019complete,
  author = {Lin, Hause},
  title = {Data science: Complete vs. partial vs. no-pooling: Fit the same model to different groups (just one simple line of code)},
  url = {https://hausetutorials.netlify.com/posts/2019-02-18-fit-models-to-every-group/},
  year = {2019}
}</pre>
</div>
<script id="distill-bibliography" type="text/bibtex">
@Article{Lorch,
author = {Lorch, Robert F. and Myers, Jerome L.},
title = {Regression analyses of repeated measures data in cognitive research.},
journal = {Journal of Experimental Psychology: Learning, Memory, and Cognition},
volume = {16},
number = {1},
pages = {149–157},
year = {1990},
abstract = {Repeated measures designs involving nonorthogonal variables are being used with increasing frequency in cognitive psychology. Researchers usually analyze the data from such designs inappropriately, probably because the designs are not discussed in standard textbooks on regression. Two commonly used approaches to analyzing repeated measures designs are considered in this article. It is argued that both approaches use inappropriate error terms for testing the effects of independent variables. A more appropriate analysis is …},
location = {},
keywords = {statistics},
url = {https://www.ncbi.nlm.nih.gov/pubmed/2136750}}
</script>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<div class="radix-site-nav radix-site-footer">
  <p>Created and managed by <a href="mailto:hauselin@gmail.com">Hause Lin</a></p>
  <p>Created with <a href="https://rstudio.github.io/radix/" target="_blank" rel="noopener noreferrer">Radix</a> in <a href="https://www.rstudio.com/" target="_blank" rel="noopener noreferrer">RStudio</a></p>
</div>
<!--/radix_placeholder_navigation_after_body-->


</body>

</html>
